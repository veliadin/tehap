{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adinv\\\\Documents\\\\GitHub\\\\tehap\\\\Tehap_FrontEnd\\\\src\\\\components\\\\ActivitySubmit.js\";\nimport React from 'react';\nimport { useEffect } from 'react';\nimport { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSelector } from 'react-redux';\nimport ProfileImageWithDefault from './ProfileImageWithDefault';\nimport { createActivity, postActivityAttachment } from '../api/apiCalls';\nimport { useApiProgress } from '../shared/ApiProgress';\nimport ButtonWithProgress from '../components/ButtonWithProgress';\nimport Input from '../components/Input';\nimport AutoUploadImage from '../components/AutoUploadImage';\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nconst ActivitySubmit = () => {\n  const {\n    image\n  } = useSelector(store => ({\n    image: store.image\n  }));\n  const [focused, setFocused] = useState(false);\n  const {\n    t\n  } = useTranslation();\n  const [errors, setErrors] = useState({});\n  const [newImage, setNewImage] = useState();\n  const [attachmentId, setAttachmentId] = useState();\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [location, setLocation] = useState('');\n  const [startDate, setStartDate] = useState(new Date());\n  const [activityHour, setActivityHour] = useState('');\n  const [activityMinute, setActivityMinute] = useState('');\n  useEffect(() => {\n    if (!focused) {\n      setTitle('');\n      setDescription('');\n      setLocation('');\n      setStartDate('');\n      setActivityMinute('');\n      setActivityHour('');\n      setErrors({});\n      setNewImage();\n      setAttachmentId();\n    }\n  }, [focused]);\n  const pendingApiCall = useApiProgress('post', '/api/createActivity', true);\n  const pendingFileUpload = useApiProgress('post', \"/api/activity-attachments\", true);\n  useEffect(() => {\n    setErrors({});\n  }, [title]);\n\n  const onChangeFile = event => {\n    if (event.target.files.length < 1) {\n      return;\n    }\n\n    const file = event.target.files[0];\n    const fileReader = new FileReader();\n\n    fileReader.onloadend = () => {\n      setNewImage(fileReader.result);\n      uploadFile(file);\n    };\n\n    fileReader.readAsDataURL(file);\n  };\n\n  const uploadFile = async file => {\n    const attachment = new FormData();\n    attachment.append('image', file);\n    const response = await postActivityAttachment(attachment);\n    setAttachmentId(response.data.id);\n  };\n\n  const onClickEvent = async () => {\n    const body = {\n      title: title,\n      attachmentId: attachmentId,\n      description: description,\n      location: location,\n      startDate: startDate,\n      activityHour: activityHour,\n      activityMinute: activityMinute\n    };\n\n    try {\n      console.log(body);\n      await createActivity(body);\n      setFocused(false);\n    } catch (error) {\n      if (error.response.data.validationErrors) {\n        setErrors(error.response.data.validationErrors);\n      }\n    }\n  };\n\n  let textAreaClass = 'form-control';\n\n  if (errors.title) {\n    textAreaClass += ' is-invalid';\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card p-1 flex-row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ProfileImageWithDefault, {\n    image: image,\n    width: \"32\",\n    height: \"32\",\n    className: \"rounded-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex-fill\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, focused && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 25\n    }\n  }, t('Enter the Title'))), /*#__PURE__*/React.createElement(\"textarea\", {\n    className: textAreaClass,\n    rows: focused ? '1' : '1',\n    onFocus: () => setFocused(true),\n    onChange: event => setTitle(event.target.value),\n    value: title,\n    placeholder: focused ? t('Enter the Title') : t('Create Activity'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"invalid-feedback\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 17\n    }\n  }, errors.title), focused && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 25\n    }\n  }, t('Enter the Description')), /*#__PURE__*/React.createElement(\"textarea\", {\n    className: textAreaClass,\n    onChange: event => setDescription(event.target.value),\n    value: description,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-7\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 33\n    }\n  }, t('When is the event?')), /*#__PURE__*/React.createElement(DatePicker, {\n    selected: startDate,\n    locale: \"es\",\n    onChange: date => setStartDate(date),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-lg-5 d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    label: t('Hour'),\n    onChange: event => setActivityHour(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 33\n    }\n  }), \" \", /*#__PURE__*/React.createElement(Input, {\n    label: t('Minute'),\n    onChange: event => setActivityMinute(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 123\n    }\n  }))), /*#__PURE__*/React.createElement(Input, {\n    label: t('Activity Location'),\n    onChange: event => setLocation(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 25\n    }\n  }), /*#__PURE__*/React.createElement(\"h6\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 25\n    }\n  }, t('Promotional Picture')), !newImage && /*#__PURE__*/React.createElement(Input, {\n    type: \"file\",\n    onChange: onChangeFile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 39\n    }\n  }), newImage && /*#__PURE__*/React.createElement(AutoUploadImage, {\n    image: newImage,\n    uploading: pendingFileUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 38\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"text-right mt-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ButtonWithProgress, {\n    className: \"btn btn-primary\",\n    onClick: onClickEvent,\n    text: \"Activity\",\n    pendingApiCall: pendingApiCall,\n    disabled: pendingApiCall || pendingFileUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-light d-inline-flex ml-1\",\n    onClick: () => setFocused(false),\n    disabled: pendingApiCall || pendingFileUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"material-icons\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 33\n    }\n  }, \"close\"), t('Cancel'))))));\n};\n\nexport default ActivitySubmit;","map":{"version":3,"sources":["C:/Users/adinv/Documents/GitHub/tehap/Tehap_FrontEnd/src/components/ActivitySubmit.js"],"names":["React","useEffect","useState","useTranslation","useSelector","ProfileImageWithDefault","createActivity","postActivityAttachment","useApiProgress","ButtonWithProgress","Input","AutoUploadImage","DatePicker","ActivitySubmit","image","store","focused","setFocused","t","errors","setErrors","newImage","setNewImage","attachmentId","setAttachmentId","title","setTitle","description","setDescription","location","setLocation","startDate","setStartDate","Date","activityHour","setActivityHour","activityMinute","setActivityMinute","pendingApiCall","pendingFileUpload","onChangeFile","event","target","files","length","file","fileReader","FileReader","onloadend","result","uploadFile","readAsDataURL","attachment","FormData","append","response","data","id","onClickEvent","body","console","log","error","validationErrors","textAreaClass","value","date"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { useEffect } from 'react';\r\nimport { useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useSelector } from 'react-redux';\r\nimport ProfileImageWithDefault from './ProfileImageWithDefault';\r\nimport { createActivity, postActivityAttachment } from '../api/apiCalls';\r\nimport { useApiProgress } from '../shared/ApiProgress';\r\nimport ButtonWithProgress from '../components/ButtonWithProgress';\r\nimport Input from '../components/Input';\r\nimport AutoUploadImage from '../components/AutoUploadImage';\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\n\r\nconst ActivitySubmit = () => {\r\n    const { image } = useSelector((store) => ({ image: store.image }));\r\n    const [focused, setFocused] = useState(false);\r\n\r\n    const { t } = useTranslation();\r\n    const [errors, setErrors] = useState({});\r\n    const [newImage, setNewImage] = useState();\r\n    const [attachmentId, setAttachmentId] = useState();\r\n\r\n    const [title, setTitle] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [location, setLocation] = useState('');\r\n    const [startDate, setStartDate] = useState(new Date());\r\n    const [activityHour, setActivityHour] = useState('');\r\n    const [activityMinute, setActivityMinute] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (!focused) {\r\n            setTitle('');\r\n            setDescription('');\r\n            setLocation('');\r\n            setStartDate('');\r\n            setActivityMinute('');\r\n            setActivityHour('');\r\n            setErrors({});\r\n            setNewImage();\r\n            setAttachmentId();\r\n        }\r\n    }, [focused]);\r\n\r\n    const pendingApiCall = useApiProgress('post', '/api/createActivity', true);\r\n    const pendingFileUpload = useApiProgress('post', \"/api/activity-attachments\", true);\r\n\r\n\r\n    useEffect(() => {\r\n        setErrors({})\r\n    }, [title]);\r\n\r\n    const onChangeFile = (event) => {\r\n        if (event.target.files.length < 1) {\r\n            return;\r\n        }\r\n        const file = event.target.files[0];\r\n        const fileReader = new FileReader();\r\n        fileReader.onloadend = () => {\r\n            setNewImage(fileReader.result);\r\n            uploadFile(file);\r\n        }\r\n        fileReader.readAsDataURL(file);\r\n    };\r\n\r\n    const uploadFile = async (file) => {\r\n        const attachment = new FormData();\r\n        attachment.append('image', file)\r\n        const response = await postActivityAttachment(attachment);\r\n        setAttachmentId(response.data.id);\r\n    }\r\n\r\n    const onClickEvent = async () => {\r\n        const body = {\r\n            title: title,\r\n            attachmentId: attachmentId,\r\n\r\n            description: description,\r\n            location: location,\r\n            startDate: startDate,\r\n            activityHour: activityHour,\r\n            activityMinute: activityMinute\r\n        };\r\n\r\n        try {\r\n            console.log(body);\r\n            await createActivity(body);\r\n            setFocused(false);\r\n        } catch (error) {\r\n            if (error.response.data.validationErrors) {\r\n                setErrors(error.response.data.validationErrors)\r\n            }\r\n        }\r\n    }\r\n\r\n    let textAreaClass = 'form-control';\r\n    if (errors.title) {\r\n        textAreaClass += ' is-invalid';\r\n    }\r\n    return (\r\n        <div className=\"card p-1 flex-row\">\r\n            <ProfileImageWithDefault image={image} width=\"32\" height=\"32\" className=\"rounded-circle\" />\r\n            <div className=\"flex-fill\">\r\n                {focused && (\r\n                    <>\r\n                        <h6>{t('Enter the Title')}</h6>\r\n                    </>\r\n                )}\r\n                <textarea className={textAreaClass}\r\n                    rows={focused ? '1' : '1'}\r\n                    onFocus={() => setFocused(true)}\r\n                    onChange={(event) => setTitle(event.target.value)}\r\n                    value={title}\r\n                    placeholder={focused ? t('Enter the Title') : t('Create Activity')}\r\n                />\r\n                <div className=\"invalid-feedback\">{errors.title}</div>\r\n                {focused && (\r\n                    <>\r\n                        <h6>{t('Enter the Description')}</h6>\r\n                        <textarea className={textAreaClass}\r\n                            onChange={(event) => setDescription(event.target.value)}\r\n                            value={description}\r\n                        />\r\n                        <div className=\"row\">\r\n                            <div className=\"col-lg-7\">\r\n                                <h6>{t('When is the event?')}</h6>\r\n                                <DatePicker selected={startDate} locale=\"es\" onChange={date => setStartDate(date)} />\r\n                            </div>\r\n                            <div className=\"col-lg-5 d-flex align-items-center\">\r\n                                <Input label={t('Hour')} onChange={event => setActivityHour(event.target.value)}></Input> <Input label={t('Minute')} onChange={event => setActivityMinute(event.target.value)}></Input>\r\n                            </div>\r\n\r\n                        </div>\r\n                        <Input label={t('Activity Location')} onChange={event => setLocation(event.target.value)}></Input>\r\n                        <h6>{t('Promotional Picture')}</h6>\r\n                        {!newImage && <Input type=\"file\" onChange={onChangeFile} />}\r\n                        {newImage && <AutoUploadImage image={newImage} uploading={pendingFileUpload} />}\r\n                        <div className=\"text-right mt-1\">\r\n\r\n\r\n                            <ButtonWithProgress className=\"btn btn-primary\"\r\n                                onClick={onClickEvent}\r\n                                text=\"Activity\"\r\n                                pendingApiCall={pendingApiCall}\r\n                                disabled={pendingApiCall || pendingFileUpload}\r\n                            />\r\n                            <button\r\n                                className=\"btn btn-light d-inline-flex ml-1\"\r\n                                onClick={() => setFocused(false)}\r\n                                disabled={pendingApiCall || pendingFileUpload}\r\n\r\n                            >\r\n                                <i className=\"material-icons\">close</i>\r\n                                {t('Cancel')}\r\n                            </button>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ActivitySubmit;"]},"metadata":{},"sourceType":"module"}